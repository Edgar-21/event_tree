from event_tree import NodeBasedTree
import matplotlib.pyplot as plt


def compare_lists(sub_list, main_list):
    missing_elements = []
    for e in main_list:
        if e not in sub_list:
            missing_elements.append(e)

    extra_elements = []
    for e in sub_list:
        if e not in main_list:
            extra_elements.append(e)
    return missing_elements, extra_elements


top_events = "Ti/DC/BO/U/B-/B2/X/SF/V1/RV/OE/NC/LM/B4/V2/OL/RB"

sequences = {
    "BO/U/B-/B2/X/SF/V1/OE/RB": [
        7.6e-4,
        4.3e-3,
        4.9e-1,
        4.1e-1,
        1e-3,
        1,
        1,
        2.75e-1,
        2e-1,
    ],
    "BO/U/B-/RV/NC/LM/RB": [7.6e-4, 4.3e-3, 4.9e-1, 5e-1, 3.6e-1, 5e-1, 2e-1],
    "BO/U/B-/RV/NC/RB": [7.6e-4, 4.3e-3, 4.9e-1, 5e-1, 3.6e-1, 2e-1],
    "BO/U/B-/V1/RV/NC/LM/RB": [
        7.6e-4,
        4.3e-3,
        4.9e-1,
        1,
        5e-1,
        3.6e-1,
        5e-1,
        2e-1,
    ],
    "BO/U/B-/B2/X/V1/NC/B4/V2/OL/RB": [
        7.6e-4,
        4.3e-3,
        4.9e-1,
        4.1e-1,
        1e-3,
        1,
        5.4e-1,
        3.4e-1,
        9e-1,
        1,
        2e-1,
    ],
    "BO/U/B-/B2/X/SF/V1/B4/V2/OL/RB": [
        7.6e-4,
        4.3e-3,
        4.9e-1,
        4.1e-1,
        1e-3,
        1,
        1,
        3.4e-1,
        9e-1,
        1,
        2e-1,
    ],
    "BO/U/B-/B2/V1/NC/B4/V2/OL/RB": [
        7.6e-4,
        4.3e-3,
        4.9e-1,
        4.1e-1,
        1,
        5.4e-1,
        3.4e-1,
        9e-1,
        1,
        2e-1,
    ],
    "BO/U/B-/B2/SF/V1/B4/V2/OL/RB": [
        7.6e-4,
        4.3e-3,
        4.9e-1,
        4.1e-1,
        1,
        1,
        3.4e-1,
        9e-1,
        1,
        2e-1,
    ],
    "DC/B-/B2/X/V1/NC/B4/V2/OL/RB": [
        5.3e-5,
        4.9e-1,
        4.1e-1,
        1,
        1,
        5.4e-1,
        3.4e-1,
        9e-1,
        1,
        2e-1,
    ],
    "DC/B-/B2/X/SF/V1/B4/V2/OL/RB": [
        5.3e-5,
        4.9e-1,
        4.1e-1,
        1,
        1,
        1,
        3.4e-1,
        8e-1,
        1,
        2e-1,
    ],
    "BO/U/B-/X/V1/RV/NC/V2/OL/RB": [
        7.6e-4,
        4.3e-3,
        4.9e-1,
        1e-3,
        1,
        5e-1,
        3.5e-1,
        1e-2,
        1,
        2e-1,
    ],
    "BO/U/B-/B2/X/V1/NC/V2/OL/RB": [
        7.6e-4,
        4.3e-3,
        4.9e-1,
        4.1e-1,
        1e-3,
        1,
        5.4e-1,
        1e-2,
        1,
        2e-1,
    ],
    "BO/U/B-/B2/X/SF/V1/V2/OL/RB": [
        7.6e-4,
        4.3e-3,
        4.9e-1,
        4.1e-1,
        1e-3,
        1,
        1,
        1e-2,
        1,
        2e-1,
    ],
    "DC/B-/B2/V1/NC/B4/V2/OL/RB": [
        5.3e-5,
        4.9e-1,
        4.1e-1,
        1,
        5.4e-1,
        3.4e-1,
        9e-1,
        1,
        2e-1,
    ],
    "DC/B-/B2/SF/V1/B4/V2/OL/RB": [
        5.3e-5,
        4.9e-1,
        4.1e-1,
        1,
        1,
        3.4e-1,
        9e-1,
        1,
        2e-1,
    ],
    "BO/U/B-/V1/RV/NC/V2/OL/RB": [
        7.6e-4,
        4.3e-3,
        4.9e-1,
        1,
        5e-1,
        3.5e-1,
        1e-2,
        1,
        2e-1,
    ],
    "BO/U/B-/B2/V1/NC/V2/OL/RB": [
        7.6e-4,
        4.3e-3,
        4.9e-1,
        4.1e-1,
        1,
        5.4e-1,
        1e-2,
        1,
        2e-1,
    ],
    "BO/U/B-/B2/SF/V1/V2/OL/RB": [
        7.6e-4,
        4.3e-3,
        4.9e-1,
        4.1e-1,
        1,
        1,
        1e-2,
        1,
        2e-1,
    ],
    "DC/B-/X/V1/RV/NC/V2/OL/RB": [
        5.3e-5,
        4.9e-1,
        1e-5,
        1,
        5e-1,
        3.6e-1,
        1e-2,
        1,
        2e-1,
    ],
    "DC/B-/B2/X/V1/NC/V2/OL/RB": [
        5.3e-5,
        4.9e-1,
        4.1e-1,
        1,
        1,
        5.4e-1,
        1e-2,
        1,
        2e-1,
    ],
    "DC/B-/B2/X/SF/V1/V2/OL/RB": [
        5.3e-5,
        4.9e-1,
        4.1e-1,
        1,
        1,
        1,
        1e-2,
        1,
        2e-1,
    ],
    "BO/U/B-/X/V1/RV/NC/LM/RB": [
        7.6e-4,
        4.3e-3,
        4.9e-1,
        1e-3,
        1,
        5e-1,
        3.5e-1,
        5e-1,
        2e-1,
    ],
    "BO/U/B-/B2/X/V1/NC/B4/RB": [
        7.6e-4,
        4.3e-3,
        4.9e-1,
        4.1e-1,
        1e-3,
        1,
        5.4e-1,
        3.4e-1,
        2e-1,
    ],
    "BO/U/B-/B2/X/V1/NC/LM/RB": [
        7.6e-4,
        4.3e-3,
        4.9e-1,
        4.1e-1,
        1e-3,
        1,
        5.4e-1,
        5e-1,
        2e-1,
    ],
    "BO/U/B-/B2/X/SF/V1/B4/RB": [
        7.6e-4,
        4.3e-3,
        4.9e-1,
        4.1e-1,
        1e-3,
        1,
        1,
        3.4e-1,
        2e-1,
    ],
    "BO/U/B-/B2/X/SF/V1/LM/RB": [
        7.6e-4,
        4.3e-3,
        4.9e-1,
        4.1e-1,
        1e-3,
        1,
        1,
        5e-1,
        2e-1,
    ],
    "BO/U/B-/B2/X/SF/V1/OE/RB": [
        7.6e-4,
        4.3e-3,
        4.9e-1,
        4.1e-1,
        1e-5,
        1,
        1,
        2.75e-1,
        2e-1,
    ],
    "DC/B-/V1/RV/NC/V2/OL/RB": [
        5.3e-5,
        4.9e-1,
        1,
        5e-1,
        3.6e-1,
        1e-2,
        1,
        2e-1,
    ],
    "DC/B-/B2/V1/NC/V2/OL/RB": [
        5.3e-5,
        4.9e-1,
        4.1e-1,
        1,
        5.4e-1,
        1e-2,
        1,
        2e-1,
    ],
    "DC/B-/B2/SF/V1/V2/OL/RB": [5.3e-5, 4.9e-1, 4.1e-1, 1, 1, 1e-2, 1, 2e-1],
    "BO/U/B-/B2/V1/NC/B4/RB": [
        7.6e-4,
        4.3e-3,
        4.9e-1,
        4.1e-1,
        1,
        5.4e-1,
        3.4e-1,
        2e-1,
    ],
    "BO/U/B-/B2/V1/NC/LM/RB": [
        7.6e-4,
        4.3e-3,
        4.9e-1,
        4.1e-1,
        1,
        5.4e-1,
        5e-1,
        2e-1,
    ],
    "BO/U/B-/B2/SF/V1/B4/RB": [
        7.6e-4,
        4.3e-3,
        4.9e-1,
        4.1e-1,
        1,
        1,
        3.4e-1,
        2e-1,
    ],
    "BO/U/B-/B2/SF/V1/LM/RB": [
        7.6e-4,
        4.3e-3,
        4.9e-1,
        4.1e-1,
        1,
        1,
        5e-1,
        2e-1,
    ],
    "DC/B-/X/V1/RV/NC/LM/RB": [
        5.3e-5,
        4.9e-1,
        1e-5,
        1,
        5e-1,
        3.6e-1,
        5e-1,
        2e-1,
    ],
    "DC/B-/B2/X/V1/NC/B4/RB": [
        5.3e-5,
        4.9e-1,
        4.1e-1,
        1,
        1,
        5.4e-1,
        3.4e-1,
        2e-2,
    ],
    "DC/B-/B2/X/V1/NC/LM/RB": [
        5.3e-5,
        4.9e-1,
        4.1e-1,
        1,
        1,
        5.4e-1,
        5e-1,
        2e-2,
    ],
    "DC/B-/B2/X/SF/V1/B4/RB": [5.3e-5, 4.9e-1, 4.1e-1, 1, 1, 1, 3.4e-1, 2e-1],
    "DC/B-/B2/X/SF/V1/LM/RB": [5.3e-5, 4.9e-1, 4.1e-1, 1, 1, 1, 5e-1, 2e-1],
    "DC/B-/B2/X/SF/V1/OE/RB": [5.3e-5, 4.9e-1, 4.1e-1, 1, 1, 1, 2.75e-1, 2e-1],
    "BO/U/B-/X/RV/NC/LM/RB": [
        7.6e-4,
        4.3e-3,
        4.9e-1,
        1e-3,
        5e-1,
        3.6e-1,
        5e-1,
        2e-1,
    ],
    "BO/U/B-/X/V1/RV/NC/RB": [
        7.6e-4,
        4.3e-3,
        4.9e-1,
        1e-3,
        1,
        5e-1,
        3.6e-1,
        2e-1,
    ],
    "BO/U/B-/X/V1/RV/OE/RB": [
        7.6e-4,
        4.3e-3,
        4.9e-1,
        1e-3,
        1,
        5e-1,
        2.75e-1,
        2e-1,
    ],
    "BO/U/B-/B2/X/NC/B4/RB": [
        7.6e-4,
        4.3e-3,
        4.9e-1,
        4.1e-1,
        1e-3,
        5.4e-1,
        3.4e-1,
        2e-1,
    ],
    "BO/U/B-/B2/X/NC/LM/RB": [
        7.6e-4,
        4.3e-3,
        4.9e-1,
        4.1e-1,
        1e-3,
        5.4e-1,
        5e-1,
        2e-1,
    ],
    "BO/U/B-/B2/X/V1/NC/RB": [
        7.6e-4,
        4.3e-3,
        4.9e-1,
        4.1e-1,
        1e-3,
        1,
        5.4e-1,
        2e-1,
    ],
    "BO/U/B-/B2/X/V1/OE/RB": [
        7.6e-4,
        4.3e-3,
        4.9e-1,
        4.1e-1,
        1e-3,
        1,
        2.75e-1,
        2e-1,
    ],
    "BO/U/B-/B2/X/SF/B4/RB": [
        7.6e-4,
        4.3e-3,
        4.9e-1,
        4.1e-1,
        1e-3,
        1,
        3.4e-1,
        2e-1,
    ],
    "BO/U/B-/B2/X/SF/LM/RB": [
        7.6e-4,
        4.3e-3,
        4.9e-1,
        4.1e-1,
        1e-3,
        1,
        5e-1,
        2e-1,
    ],
    "DC/B-/V1/RV/NC/LM/RB": [5.3e-5, 4.9e-1, 1, 5e-1, 3.6e-1, 5e-1, 2e-1],
    "DC/B-/B2/V1/NC/B4/RB": [5.3e-5, 4.9e-1, 4.1e-1, 1, 5.4e-1, 3.4e-1, 2e-1],
    "DC/B-/B2/V1/NC/LM/RB": [5.3e-5, 4.9e-1, 4.1e-1, 1, 5.4e-1, 5e-1, 2e-1],
    "DC/B-/B2/SF/V1/B4/RB": [5.3e-5, 4.9e-1, 4.1e-1, 1, 1, 3.4e-1, 2e-1],
    "DC/B-/B2/SF/V1/LM/RB": [5.3e-5, 4.9e-1, 4.1e-1, 1, 1, 5e-1, 2e-1],
    "BO/U/B-/V1/RV/NC/RB": [7.6e-4, 4.3e-3, 4.9e-1, 1, 5e-1, 3.6e-1, 2e-1],
    "BO/U/B-/B2/NC/B4/RB": [
        7.6e-4,
        4.3e-3,
        4.9e-1,
        4.1e-1,
        5.4e-1,
        3.4e-1,
        2e-1,
    ],
    "BO/U/B-/B2/NC/LM/RB": [
        7.6e-4,
        4.3e-3,
        4.9e-1,
        4.1e-1,
        5.4e-1,
        5e-1,
        2e-1,
    ],
    "BO/U/B-/B2/V1/NC/RB": [7.6e-4, 4.3e-3, 4.9e-1, 4.1e-1, 1, 5.4e-1, 2e-1],
    "BO/U/B-/B2/SF/B4/RB": [7.6e-4, 4.3e-3, 4.9e-1, 4.1e-1, 1, 3.4e-1, 2e-1],
    "BO/U/B-/B2/SF/LM/RB": [7.6e-4, 4.3e-3, 4.9e-1, 4.1e-1, 1, 5e-1, 2e-1],
    "BO/U/B-/B2/SF/V1/RB": [7.6e-4, 4.3e-3, 4.9e-1, 4.1e-1, 1, 1, 2e-1],
    "DC/B-/X/RV/NC/LM/RB": [5.3e-5, 4.9e-1, 1e-3, 5e-1, 3.6e-1, 5e-1, 2e-1],
    "DC/B-/X/V1/RV/NC/RB": [5.3e-5, 4.9e-1, 1e-3, 1, 5e-1, 3.6e-1, 2e-1],
    "DC/B-/X/V1/RV/OE/RB": [5.3e-5, 4.9e-1, 1e-3, 1, 5e-1, 2.75e-1, 2e-1],
    "BO/U/B-/B2/X/SF/V1/RB": [
        7.6e-4,
        4.3e-3,
        4.9e-1,
        4.1e-1,
        1e-3,
        1,
        1,
        2e-1,
    ],
    "DC/B-/B2/X/NC/B4/RB": [5.3e-5, 4.9e-1, 4.1e-1, 1, 5.4e-1, 3.4e-1, 2e-1],
    "DC/B-/B2/X/NC/LM/RB": [5.3e-5, 4.9e-1, 4.1e-1, 1, 5.4e-1, 5e-1, 2e-1],
    "DC/B-/B2/X/V1/NC/RB": [5.3e-5, 4.9e-1, 4.1e-1, 1, 1, 5.4e-1, 2e-1],
    "DC/B-/B2/X/V1/OE/RB": [5.3e-5, 4.9e-1, 4.1e-1, 1, 1, 2.75e-1, 2e-1],
    "DC/B-/B2/X/SF/B4/RB": [5.3e-5, 4.9e-1, 4.1e-1, 1, 1, 3.4e-1, 2e-1],
    "DC/B-/B2/X/SF/LM/RB": [5.3e-5, 4.9e-1, 4.1e-1, 1, 1, 5e-1, 2e-1],
    "DC/B-/B2/X/SF/V1/RB": [5.3e-5, 4.9e-1, 4.1e-1, 1, 1, 1, 2e-1],
    "BO/U/B-/X/RV/NC/RB": [7.6e-4, 4.3e-3, 4.9e-1, 1e-3, 5e-1, 3.6e-1, 2e-1],
    "BO/U/B-/B2/X/NC/RB": [7.6e-4, 4.3e-3, 4.9e-1, 4.1e-1, 1e-3, 5.4e-1, 2e-1],
    "BO/U/B-/B2/X/SF/RB": [7.6e-4, 4.3e-3, 4.9e-1, 4.1e-1, 1e-3, 1, 2e-1],
    "DC/B-/RV/NC/LM/RB": [5.3e-5, 4.9e-1, 5e-1, 3.6e-1, 5e-1, 2e-1],
    "DC/B-/V1/RV/NC/RB": [5.3e-5, 4.9e-1, 1, 5e-1, 3.6e-1, 2e-1],
    "DC/B-/B2/NC/B4/RB": [5.3e-5, 4.9e-1, 4.1e-1, 5.4e1, 3.4e-1, 2e-1],
    "DC/B-/B2/NC/LM/RB": [5.3e-5, 4.9e-1, 4.1e-1, 5.4e1, 5e-1, 2e-1],
    "DC/B-/B2/V1/NC/RB": [5.3e-5, 4.9e-1, 4.1e-1, 1, 5.4e-1, 2e-1],
    "DC/B-/B2/SF/B4/RB": [5.3e-5, 4.9e-1, 4.1e-1, 1, 3.4e-1, 2e-1],
    "DC/B-/B2/SF/LM/RB": [5.3e-5, 4.9e-1, 4.1e-1, 1, 5e-1, 2e-1],
    "DC/B-/B2/SF/V1/RB": [5.3e-5, 4.9e-1, 4.1e-1, 1, 1, 2e-1],
    "BO/U/B-/B2/NC/RB": [7.6e-4, 4.3e-3, 4.9e-1, 4.1e-1, 5.4e-1, 2e-1],
    "BO/U/B-/B2/SF/RB": [7.6e-4, 4.3e-3, 4.9e-1, 4.1e-1, 1, 2e-1],
    "DC/B-/X/RV/NC/RB": [5.3e-5, 4.9e-1, 1e-3, 5e-1, 3.6e-1, 2e-1],
    "DC/B-/B2/X/NC/RB": [5.3e-5, 4.9e-1, 4.1e-1, 1, 5.4e-1, 2e-1],
    "DC/B-/B2/X/SF/RB": [5.3e-5, 4.9e-1, 4.1e-1, 1, 1, 2e-1],
    "DC/B-/RV/NC/RB": [5.3e-5, 4.9e-1, 5e-1, 3.6e-1, 2e-1],
    "DC/B-/B2/NC/RB": [5.3e-5, 4.9e-1, 4.1e-1, 5.4e-1, 2e-1],
    "DC/B-/B2/SF/RB": [5.3e-5, 4.9e-1, 4.1e-1, 1, 2e-1],
}

initiating_frequency = 8e-2
tree = NodeBasedTree(initiating_frequency, top_events)
for sequence, split_fractions in sequences.items():
    tree.add_sequence(sequence, split_fractions)

fig, end_label_list = tree.plot_tree(y_step=-0.3, x_step=1)
plt.axis("off")
plt.savefig("sbo_event_tree.png", bbox_inches="tight")
plt.savefig("sbo_event_tree.pdf", bbox_inches="tight")

with open("sbo_events.txt", "r") as f:
    end_events = [line.strip() for line in f]

missing_events, extra_events = compare_lists(end_label_list, end_events)

print(len(end_events))
print(len(missing_events))
print(len(end_label_list))
print(len(extra_events))
missing_events.sort(key=len, reverse=True)
print(extra_events)
